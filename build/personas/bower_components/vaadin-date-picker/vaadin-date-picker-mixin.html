<html><head><link rel="import" href="../iron-a11y-keys-behavior/iron-a11y-keys-behavior.html"><link rel="import" href="../iron-resizable-behavior/iron-resizable-behavior.html"><link rel="import" href="vaadin-date-picker-helper.html"><script src="../moment/moment.js"></script><script>window.Vaadin=window.Vaadin||{},window.moment=window.moment||{},Vaadin.DatePickerMixin=function(a){return function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:'ready',value:function(){babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'ready',this).call(this),this._boundOnScroll=this._onScroll.bind(this),this.addEventListener('tap',this.open.bind(this)),this.addEventListener('touchend',this._preventDefault.bind(this)),this.addEventListener('keydown',this._onKeydown.bind(this)),this.addEventListener('close',this._close.bind(this)),this.addEventListener('date-tap',this._close.bind(this)),this.addEventListener('focus-input',this._focusAndSelect.bind(this)),this.addEventListener('input',this._onUserInput.bind(this))}},{key:'open',value:function(){this.disabled||this.readonly||(this.$.dropdown.open(),this._updateAlignmentAndPosition())}},{key:'_close',value:function(a){a&&a.stopPropagation(),this._focus(),this.close()}},{key:'close',value:function(){this.$.dropdown.close()}},{key:'_parseDate',value:function(a){var b=/^(\d{4}|[-+]\d{6})-(\d{2})-(\d{2})$/.exec(a);if(b){var c=new Date(0,0);return c.setFullYear(parseInt(b[1],10)),c.setMonth(parseInt(b[2],10)-1),c.setDate(parseInt(b[3],10)),c}}},{key:'_isNoInput',value:function(){return!this._inputElement||this._fullscreen||!this.i18n.parseDate||this._ios}},{key:'_formatISO',value:function(a){return a instanceof Date?new Date(a.getTime()-6e4*a.getTimezoneOffset()).toISOString().split('T')[0]:''}},{key:'_selectedDateChanged',value:function(a,b){void 0===a||void 0===b||(this.value=this._formatISO(a),this._focusedDate=a,this._inputValue=a?b(a):'')}},{key:'_focusedDateChanged',value:function(a,b){void 0!==a&&void 0!==b&&(this._ignoreFocusedDateChange||this._noInput||(this._inputValue=a?b(a):''))}},{key:'_hasValue',value:function(a){return!!a}},{key:'_handleDateChange',value:function(a,b,c){if(!b)return void(this[a]='');var d=this._parseDate(b);return d?void(!Vaadin.DatePickerHelper._dateEquals(this[a],d)&&(this[a]=d)):void(this.value=c)}},{key:'_valueChanged',value:function(a,b){this._handleDateChange('_selectedDate',a,b)}},{key:'_minChanged',value:function(a,b){this._handleDateChange('_minDate',a,b)}},{key:'_maxChanged',value:function(a,b){this._handleDateChange('_maxDate',a,b)}},{key:'_updateAlignmentAndPosition',value:function(){var a=Math.max,b=a(document.documentElement.clientWidth,window.innerWidth||0);this.$.dropdown.positionTarget=this._fullscreen?document.documentElement:this;var c=a(document.documentElement.clientHeight,window.innerHeight||0),d=this.getBoundingClientRect().top>c/2,e=this.getBoundingClientRect().left+this.clientWidth/2>b/2;this.$.dropdown.verticalAlign=d?'bottom':'top',this.$.dropdown.horizontalAlign=this._fullscreen?null:e?'right':'left',this._fullscreen?(this.$.dropdown.style.marginTop=0,this.$.dropdown.style.marginBottom=0):(this.$.dropdown.style.marginTop=(d?10:this.clientHeight+2)+'px',this.$.dropdown.style.marginBottom=(d?this.clientHeight:10)+'px'),this.$.overlay._repositionYearScroller()}},{key:'_fullscreenChanged',value:function(){this.$.dropdown.opened&&this._updateAlignmentAndPosition()}},{key:'_onOverlayOpened',value:function(){var a=this._parseDate(this.initialPosition),b=this._selectedDate||this.$.overlay.initialPosition||a||new Date;this.$.overlay.initialPosition=a||Vaadin.DatePickerHelper._dateAllowed(b,this._minDate,this._maxDate)?b:Vaadin.DatePickerHelper._getClosestDate(b,[this._minDate,this._maxDate]),this.$.overlay.scrollToDate(this.$.overlay.focusedDate||this.$.overlay.initialPosition),this._ignoreFocusedDateChange=!0,this.$.overlay.focusedDate=this.$.overlay.focusedDate||this.$.overlay.initialPosition,this._ignoreFocusedDateChange=!1,window.addEventListener('scroll',this._boundOnScroll,!0),this.listen(this,'iron-resize','_updateAlignmentAndPosition'),''===document.createElement('div').style.webkitOverflowScrolling&&(this._touchPrevented=this._preventWebkitOverflowScrollingTouch(this.parentElement)),this._focusOverlayOnOpen?(this.$.overlay.focus(),this._focusOverlayOnOpen=!1):this._focus(),this.updateStyles(),this._documentPointerEvents=document.body.style.pointerEvents,document.body.style.pointerEvents='none';var c=this.style.pointerEvents;this.style.pointerEvents='auto',this.style.pointerEvents=c,this._ignoreAnnounce=!1}},{key:'_preventWebkitOverflowScrollingTouch',value:function(a){for(var b=[];a;){if('touch'===window.getComputedStyle(a).webkitOverflowScrolling){var c=a.style.webkitOverflowScrolling;a.style.webkitOverflowScrolling='auto',b.push({element:a,oldInlineValue:c})}a=a.parentElement}return b}},{key:'_onOverlayClosed',value:function(){if(this._ignoreAnnounce=!0,window.removeEventListener('scroll',this._boundOnScroll,!0),this.unlisten(this,'iron-resize','_updateAlignmentAndPosition'),this._touchPrevented&&(this._touchPrevented.forEach(function(a){return a.element.style.webkitOverflowScrolling=a.oldInlineValue}),this._touchPrevented=[]),this.updateStyles(),document.body.style.pointerEvents=this._documentPointerEvents,this._ignoreFocusedDateChange=!0,this.i18n.parseDate){var a=this._inputValue||'',b=this.i18n.parseDate(a);this._isValidDate(b)?this._selectedDate=b:(this._selectedDate=null,this._inputValue=a)}else this._focusedDate&&(this._selectedDate=this._focusedDate);this._ignoreFocusedDateChange=!1,this._nativeInput&&this._nativeInput.selectionStart&&(this._nativeInput.selectionStart=this._nativeInput.selectionEnd),this.validate()}},{key:'detached',value:function(){this._onOverlayClosed()}},{key:'validate',value:function(a){return a=void 0===a?this._inputValue:a,!(this.invalid=!this.checkValidity(a))}},{key:'checkValidity',value:function(a){var b=!a||this._selectedDate&&a===this.i18n.formatDate(this._selectedDate),c=!this._selectedDate||Vaadin.DatePickerHelper._dateAllowed(this._selectedDate,this._minDate,this._maxDate),d=!0;return this._inputElement&&(this._inputElement.checkValidity?d=this._inputElement.checkValidity(a):this._inputElement.validate&&(d=this._inputElement.validate(a))),b&&c&&d}},{key:'_onScroll',value:function(a){a.target!==window&&this.$.overlay.contains(a.target)||this._updateAlignmentAndPosition()}},{key:'_preventCancelOnComponentAccess',value:function(a){var b=a.detail;/tap|mousedown|touchstart/.test(a.detail.type)&&-1<b.composedPath().indexOf(this)&&a.preventDefault()}},{key:'_focus',value:function(){this._noInput?this.$.overlay.focus():this._inputElement.focus()}},{key:'_focusAndSelect',value:function(){this._focus(),this._setSelectionRange(0,this._inputValue.length)}},{key:'_setSelectionRange',value:function(c,a){this._nativeInput&&this._nativeInput.setSelectionRange&&this._nativeInput.setSelectionRange(c,a)}},{key:'_preventDefault',value:function(a){a.preventDefault()}},{key:'_eventKey',value:function(a){for(var b,c=['down','up','enter','esc','tab'],d=0;d<c.length;d++)if(b=c[d],Polymer.IronA11yKeysBehavior.keyboardEventMatchesKeys(a,b))return b}},{key:'_isValidDate',value:function(a){return a&&!isNaN(a.getTime())}},{key:'_onKeydown',value:function(a){if(this._noInput){-1===[9].indexOf(a.keyCode)&&a.preventDefault()}switch(this._eventKey(a)){case'down':case'up':a.preventDefault(),this.opened?(this.$.overlay.focus(),this.$.overlay._onKeydown(a)):(this._focusOverlayOnOpen=!0,this.open());break;case'enter':this.$.overlay.focusedDate&&(this._selectedDate=this.$.overlay.focusedDate),this.close();break;case'esc':this._focusedDate=this._selectedDate,this._close();break;case'tab':this.opened&&(a.preventDefault(),this._setSelectionRange(0,0),a.shiftKey?this.$.overlay.focusCancel():(this.$.overlay.focus(),this.$.overlay.revealDate(this._focusedDate)));}}},{key:'_validateInput',value:function(a,b,c){a&&(b||c)&&(this.invalid=!Vaadin.DatePickerHelper._dateAllowed(a,b,c))}},{key:'_onUserInput',value:function(){this._userInputValueChanged(),this.opened||(this.open(),this._ios&&(this._debouncerRefit=Polymer.Debouncer.debounce(this._debouncerRefit,Polymer.Async.timeOut.after(500),this.$.dropdown.refit)))}},{key:'_userInputValueChanged',value:function(){if(this.opened&&this._inputValue){var a=this.i18n.parseDate&&this.i18n.parseDate(this._inputValue);this._isValidDate(a)&&(this._ignoreFocusedDateChange=!0,this._focusedDate=a,this._ignoreFocusedDateChange=!1)}}},{key:'_announceFocusedDate',value:function(a,b,c){b&&!c&&this.$.overlay.announceFocusedDate()}},{key:'_inputElement',get:function(){return this._input()}},{key:'_nativeInput',get:function(){if(this._inputElement)return this._inputElement.focusElement?this._inputElement.focusElement:this._inputElement.inputElement?this._inputElement.inputElement:window.unwrap?window.unwrap(this._inputElement):this._inputElement}}],[{key:'properties',get:function(){return{_selectedDate:{type:Date},_focusedDate:Date,value:{type:String,observer:'_valueChanged',notify:!0,value:''},required:{type:Boolean,value:!1},name:{type:String},hasValue:{type:Boolean,computed:'_hasValue(value)',reflectToAttribute:!0},initialPosition:String,label:String,opened:{type:Boolean,reflectToAttribute:!0,notify:!0},showWeekNumbers:{type:Boolean},_fullscreen:{value:!1,observer:'_fullscreenChanged'},_fullscreenMediaQuery:{value:'(max-width: 420px), (max-height: 420px)'},_touchPrevented:Array,i18n:{type:Object,value:function(){return{monthNames:['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Deciembre'],weekdays:['Domingo','Lunes','Martes','Miercoles','Jueves','Viernes','Sabado'],weekdaysShort:['Dom','Lun','Mar','Mie','Jue','Vie','Sab'],firstDayOfWeek:0,week:'Semana',calendar:'Calendario',clear:'Limpiar',today:'Hoy',cancel:'Cancelar',formatDate:function(a){return moment(a).format('DD/MM/YYYY')},parseDate:function(a){return moment(a,'DD/MM/YYYY').toDate()},formatTitle:function(a,b){return a+' '+b}}}},min:{type:String,observer:'_minChanged'},max:{type:String,observer:'_maxChanged'},_minDate:{type:Date,value:''},_maxDate:{type:Date,value:''},_noInput:{type:Boolean,computed:'_isNoInput(_fullscreen, i18n, i18n.*, _ios)'},_ios:{type:Boolean,value:navigator.userAgent.match(/iP(?:hone|ad;(?: U;)? CPU) OS (\d+)/)},_ignoreAnnounce:{value:!0},_focusOverlayOnOpen:Boolean,_documentPointerEvents:String}}},{key:'observers',get:function(){return['_validateInput(_selectedDate, _minDate, _maxDate)','_selectedDateChanged(_selectedDate, i18n.formatDate)','_focusedDateChanged(_focusedDate, i18n.formatDate)','_announceFocusedDate(_focusedDate, opened, _ignoreAnnounce)']}}]),b}(Polymer.mixinBehaviors([Polymer.IronA11yKeysBehavior,Polymer.IronResizableBehavior],a))};</script></head><body></body></html>