<html><head><script>window.Vaadin=window.Vaadin||{},window.Vaadin.Grid=window.Vaadin.Grid||{},Vaadin.Grid.ItemCache=function(){function a(b,c,d){babelHelpers.classCallCheck(this,a),this.grid=b,this.parentCache=c,this.parentItem=d,this.itemCaches={},this.items={},this.effectiveSize=0,this.size=0,this.pendingRequests={}}return babelHelpers.createClass(a,[{key:'isLoading',value:function(){var a=this;return Object.keys(this.pendingRequests).length||Object.keys(this.itemCaches).filter(function(b){return a.itemCaches[b].isLoading()})[0]}},{key:'getItemForIndex',value:function(a){var b=this.getCacheAndIndex(a),c=b.cache,d=b.scaledIndex;return c.items[d]}},{key:'updateSize',value:function(){var a=this;this.effectiveSize=!this.parentItem||this.grid._isExpanded(this.parentItem)?this.size+Object.keys(this.itemCaches).reduce(function(b,c){var d=a.itemCaches[c];return d.updateSize(),b+d.effectiveSize},0):0}},{key:'ensureSubCacheForScaledIndex',value:function(a){if(!this.itemCaches[a]){var b=new Vaadin.Grid.ItemCache(this.grid,this,this.items[a]);this.itemCaches[a]=b,this.grid._loadPage(0,b)}}},{key:'getCacheAndIndex',value:function(a){for(var b=a,c=Object.keys(this.itemCaches),d=0;d<c.length;d++){var e=+c[d],f=this.itemCaches[e];if(b<=e)return{cache:this,scaledIndex:b};if(b<=e+f.effectiveSize)return f.getCacheAndIndex(b-e-1);b-=f.effectiveSize}return{cache:this,scaledIndex:b}}}]),a}(),Vaadin.Grid.DataProviderMixin=function(a){return function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:'_sizeChanged',value:function(a){var b=a-this._cache.size;this._cache.size+=b,this._cache.effectiveSize+=b,this._effectiveSize=this._cache.effectiveSize}},{key:'_updateRowItem',value:function(a,b){b.children.forEach(function(b){b._instance&&(b._instance.item=a)})}},{key:'_getItem',value:function(a,b){if(!(a>=this._effectiveSize)){b.index=a;var c=this._cache.getCacheAndIndex(a),d=c.cache,e=c.scaledIndex,f=d.items[e];f?(b.removeAttribute('loading'),this._updateItem(b,f),this._isExpanded(f)&&d.ensureSubCacheForScaledIndex(e)):(b.setAttribute('loading',''),this._loadPage(this._getPageForIndex(e),d))}}},{key:'_pagesForPhysicalItems',value:function(){var a=this,b=this._getPageForIndex(this._firstVisibleIndex+this._vidxOffset);return[b].concat(this._physicalItems.filter(function(a){return a.index}).items(function(b){return a._getPageForIndex(b.index)})).reduce(function(a,b){return-1===a.indexOf(b)&&a.push(b),a},[])}},{key:'_expandedInstanceChangedCallback',value:function(a,b){void 0===a.item||(b?this.expandItem(a.item):this.collapseItem(a.item))}},{key:'getItemId',value:function(a){return this.itemIdPath?this.get(this.itemIdPath,a):a}},{key:'_isExpanded',value:function(a){return this.expandedItems&&-1<this._getItemIndexInArray(a,this.expandedItems)}},{key:'_expandedItemsChanged',value:function(){this._cache.updateSize(),this._effectiveSize=this._cache.effectiveSize,this._assignModels()}},{key:'expandItem',value:function(a){this._isExpanded(a)||this.push('expandedItems',a)}},{key:'collapseItem',value:function(a){this._isExpanded(a)&&this.splice('expandedItems',this._getItemIndexInArray(a,this.expandedItems),1)}},{key:'_getIndexLevel',value:function(a){for(var b=this._cache.getCacheAndIndex(a),c=b.cache,d=0;c.parentCache;)c=c.parentCache,d++;return d}},{key:'_canPopulate',value:function(){return this._hasData}},{key:'_loadPage',value:function(a,b){var c=this;if(!b.pendingRequests[a]&&this.dataProvider){this._setLoading(!0),b.pendingRequests[a]=!0;var d={page:a,pageSize:this.pageSize,sortOrders:this._mapSorters(),filters:this._mapFilters(),parentItem:b.parentItem};this.dataProvider(d,function(e,f){void 0===f?d.parentItem&&(b.size=e.length):b.size=f,e.forEach(function(d,e){b.items[a*c.pageSize+e]=d}),c._cache.updateSize(),c._effectiveSize=c._cache.effectiveSize,Array.from(c.$.items.children).forEach(function(a){var b=c._cache.getItemForIndex(a.index);-1<e.indexOf(b)&&(a.removeAttribute('loading'),c._updateItem(a,b))}),c._hasData=!0,c._increasePoolIfNeeded(0),delete b.pendingRequests[a],c._setLoading(c._cache.isLoading())})}}},{key:'_getPageForIndex',value:function(a){return Math.floor(a/this.pageSize)}},{key:'clearCache',value:function(){this._cache=new Vaadin.Grid.ItemCache(this),this._cache.size=this.size,this._cache.updateSize(),this._hasData=!1,this._assignModels(),this._effectiveSize||this._loadPage(0,this._cache)}},{key:'_flushItemsDebouncer',value:function(){this._debouncerLoad&&this._debouncerLoad.flush()}},{key:'_pageSizeChanged',value:function(a,b){void 0!==b&&a!==b&&this.clearCache()}},{key:'_checkSize',value:function(){void 0===this.size&&0===this._effectiveSize&&console.warn('The <vaadin-grid> needs the total number of items in order to display rows. Set the total number of items to the `size` property, or provide the total number of items in the second argument of the `dataProvider`\u2019s `callback` call.')}},{key:'_dataProviderChanged',value:function(a,b){void 0!==b&&this.clearCache(),a&&this.items&&this.items.length&&this._scrollToIndex(this._firstVisibleIndex),this._ensureFirstPageLoaded(),this._debouncerCheckSize=Polymer.Debouncer.debounce(this._debouncerCheckSize,Polymer.Async.timeOut.after(2e3),this._checkSize.bind(this)),this._scrollHandler()}},{key:'_ensureFirstPageLoaded',value:function(){var a=this;this._hasData||this._loadPage(0,this._cache,function(){var b=a._hasData;a._hasData=!0,b||a.notifyResize()})}},{key:'_itemsEqual',value:function(a,b){return this.getItemId(a)===this.getItemId(b)}},{key:'_getItemIndexInArray',value:function(a,b){var c=this,d=-1;return b.forEach(function(b,e){c._itemsEqual(b,a)&&(d=e)}),d}}],[{key:'properties',get:function(){return{pageSize:{type:Number,value:50,observer:'_pageSizeChanged'},dataProvider:{type:Object,notify:!0,observer:'_dataProviderChanged'},loading:{type:Boolean,notify:!0,readOnly:!0,reflectToAttribute:!0},_cache:{type:Object,value:function(){var a=new Vaadin.Grid.ItemCache(this);return a}},itemIdPath:{type:String,value:null},expandedItems:{type:Object,notify:!0,value:function(){return[]}}}}},{key:'observers',get:function(){return['_sizeChanged(size)','_expandedItemsChanged(expandedItems.*)']}}]),b}(a)};</script></head><body></body></html>