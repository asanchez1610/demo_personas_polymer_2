<html><head><script>window.Vaadin=window.Vaadin||{},Vaadin.Grid=Vaadin.Grid||{},Vaadin.Grid.KeyboardNavigationMixin=function(a){return function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:'ready',value:function(){var a=this;babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'ready',this).call(this),this._ios||this._android||(this.addEventListener('keydown',this._onKeyDown),this.addEventListener('focusin',this._onFocusIn),this.addEventListener('focusout',this._onFocusOut),this.$.table.addEventListener('focusin',this._onCellFocusIn.bind(this)),this.$.table.addEventListener('focusout',this._onCellFocusOut.bind(this)),this.addEventListener('mousedown',function(){a._toggleAttribute('navigating',!1,a),a._isMousedown=!0}),this.addEventListener('mouseup',function(){return a._isMousedown=!1}))}},{key:'_focusableChanged',value:function(a,b){b&&b.setAttribute('tabindex','-1'),a&&a.setAttribute('tabindex','0')}},{key:'_onKeyDown',value:function(a){a.stopImmediatePropagation();var b=a.key;('Up'===b||'Down'===b||'Left'===b||'Right'===b)&&(b='Arrow'+b),'Esc'===b&&(b='Escape'),'Spacebar'===b&&(b=' ');var c;'ArrowUp'===b||'ArrowDown'===b||'ArrowLeft'===b||'ArrowRight'===b||'PageUp'===b||'PageDown'===b||'Home'===b||'End'===b?c='Navigation':'Enter'===b||'Escape'===b||'F2'===b?c='Interaction':'Tab'===b?c='Tab':' '===b?c='Space':void 0,this._detectInteracting(a),this.hasAttribute('interacting')&&'Interaction'!==c&&(c=void 0),c&&this['_on'+c+'KeyDown'](a,b)}},{key:'_ensureScrolledToIndex',value:function(a){var b=this._lastVisibleIndex-this._firstVisibleIndex-1;a<=this._firstVisibleIndex?this._scrollToIndex(a):a>=this._firstVisibleIndex+b&&this._scrollToIndex(a-b)}},{key:'_onNavigationKeyDown',value:function(a,b){function c(a){return Array.prototype.indexOf.call(a.parentNode.children,a)}var d=Math.max,e=Math.min,f=this;a.preventDefault();var g=this._lastVisibleIndex-this._firstVisibleIndex-1,h=0,i=0;'ArrowRight'===b?h=1:'ArrowLeft'===b?h=-1:'Home'===b?(h=-Infinity,a.ctrlKey&&(i=-Infinity)):'End'===b?(h=Infinity,a.ctrlKey&&(i=Infinity)):'ArrowDown'===b?i=1:'ArrowUp'===b?i=-1:'PageDown'===b?i=g:'PageUp'===b?i=-g:void 0;var j=a.composedPath()[0],k=c(j),l=this._elementMatches(j,'[part~="details-cell"]'),m=j.parentNode,n=m.parentNode,o=(n===this.$.items?this._effectiveSize:n.children.length)-1,p=n===this.$.items?void 0===this._focusedItemIndex?m.index:this._focusedItemIndex:c(m),q=d(0,e(p+i,o)),r=!1;if(n===this.$.items){var s=m._item,t=this._cache.getItemForIndex(q);r=l?0===i:1===i&&this._isDetailsOpened(s)||-1===i&&q!==p&&this._isDetailsOpened(t),r!==l&&(1===i&&r||-1===i&&!r)&&(q=p)}if(n!==this.$.items)if(q>p)for(;q<o&&n.children[q].hidden;)q++;else if(q<p)for(;0<q&&n.children[q].hidden;)q--;void 0===this._focusedColumnOrder&&(l?this._focusedColumnOrder=0:this._focusedColumnOrder=this._getColumns(n,p)[k]._order);var u=this._getColumns(n,q),v=u.filter(function(a){return!a.hidden}).map(function(a){return a._order}).sort(),w=v.length-1,x=v.indexOf(v.slice(0).sort(function(c,b){var a=Math.abs;return a(c-f._focusedColumnOrder)-a(b-f._focusedColumnOrder)})[0]),y=0===i&&l?x:d(0,e(x+h,w));y!==x&&(this._focusedColumnOrder=void 0),n===this.$.items&&this._ensureScrolledToIndex(q),this._toggleAttribute('navigating',!0,this);var z=u.reduce(function(a,b,c){return a[b._order]=c,a},{}),A=z[v[y]],B=n===this.$.items?Array.from(n.children).filter(function(a){return a.index===q})[0]:n.children[q];if(B){var C=r?Array.from(B.children).filter(function(a){return f._elementMatches(a,'[part~="details-cell"]')})[0]:B.children[A];if(this._scrollHorizontallyToCell(C),n===this.$.items&&(this._focusedItemIndex=q),n===this.$.items){var D=C.getBoundingClientRect(),E=this.$.footer.getBoundingClientRect().top,F=this.$.header.getBoundingClientRect().bottom;D.bottom>E?(this.$.table.scrollTop+=D.bottom-E,this._scrollHandler()):D.top<F&&(this.$.table.scrollTop-=F-D.top,this._scrollHandler())}C.focus()}}},{key:'_parseEventPath',value:function(a){var b=a.indexOf(this.$.table);return{rowGroup:a[b-1],row:a[b-2],cell:a[b-3]}}},{key:'_onInteractionKeyDown',value:function(a,b){var c,d=a.composedPath()[0],e='input'===d.localName&&!/^(button|checkbox|color|file|image|radio|range|reset|submit)$/i.test(d.type);'Enter'===b?c=!this.hasAttribute('interacting')||!e:'Escape'===b?c=!1:'F2'===b?c=!this.hasAttribute('interacting'):void 0;var f=this._parseEventPath(a.composedPath()),g=f.cell;if(this.hasAttribute('interacting')!==c)if(c){var h=g._content.querySelector('[focus-target]')||g._content.firstElementChild;h&&(a.preventDefault(),h.focus(),this._toggleAttribute('interacting',!0,this),this._toggleAttribute('navigating',!1,this))}else a.preventDefault(),this._focusedColumnOrder=void 0,g.focus(),this._toggleAttribute('interacting',!1,this),this._toggleAttribute('navigating',!0,this)}},{key:'_predictFocusStepTarget',value:function(a,b){var c=[this.$.table,this._headerFocusable,this._itemsFocusable,this._footerFocusable,this.$.focusexit],d=c.indexOf(a);for(d+=b;0<=d&&d<=c.length-1&&(!c[d]||c[d].parentNode.hidden);)d+=b;return c[d]}},{key:'_onTabKeyDown',value:function(a){var b=this,c=this._predictFocusStepTarget(a.composedPath()[0],a.shiftKey?-1:1);if(c===this.$.table)this.$.table.focus();else if(c===this.$.focusexit)this.$.focusexit.focus();else if(c===this._itemsFocusable){var d=c,e=this._itemsFocusable.parentNode;if(this._ensureScrolledToIndex(this._focusedItemIndex),e.index!==this._focusedItemIndex){var f=Array.from(e.children).indexOf(this._itemsFocusable),g=Array.from(this.$.items.children).filter(function(a){return a.index===b._focusedItemIndex})[0];g&&(d=g.children[f])}a.preventDefault(),d.focus()}else a.preventDefault(),c.focus();this._toggleAttribute('navigating',!0,this)}},{key:'_onSpaceKeyDown',value:function(a){a.preventDefault();var b=a.composedPath()[0];if(b._content&&b._content.firstElementChild){var c=this.hasAttribute('navigating');b._content.firstElementChild.click(),this._toggleAttribute('navigating',c,this)}else this.dispatchEvent(new CustomEvent('cell-activate',{detail:{model:b._instance}}))}},{key:'_onFocusIn',value:function(a){this._isMousedown||this._toggleAttribute('navigating',!0,this);var b=a.composedPath()[0];b===this.$.table||b===this.$.focusexit?(this._predictFocusStepTarget(b,b===this.$.table?1:-1).focus(),this._toggleAttribute('interacting',!1,this)):this._detectInteracting(a)}},{key:'_onFocusOut',value:function(a){this._toggleAttribute('navigating',!1,this),this._detectInteracting(a)}},{key:'_onCellFocusIn',value:function(a){if(this._detectInteracting(a),3===a.composedPath().indexOf(this.$.table)){var b=a.composedPath()[0],c=b.parentNode.parentNode;c===this.$.header?this._headerFocusable=b:c===this.$.items?this._itemsFocusable=b:c===this.$.footer&&(this._footerFocusable=b),b._content.dispatchEvent(new CustomEvent('cell-focusin',{bubbles:!1}))}this._detectFocusedItemIndex(a)}},{key:'_onCellFocusOut',value:function(a){if(3===a.composedPath().indexOf(this.$.table)){var b=a.composedPath()[0];b._content.dispatchEvent(new CustomEvent('cell-focusout',{bubbles:!1}))}}},{key:'_detectInteracting',value:function(a){this._toggleAttribute('interacting',a.composedPath().some(function(a){return'vaadin-grid-cell-content'===a.localName}),this)}},{key:'_detectFocusedItemIndex',value:function(a){var b=this._parseEventPath(a.composedPath()),c=b.rowGroup,d=b.row;c===this.$.items&&(this._focusedItemIndex=d.index)}},{key:'_preventScrollerRotatingCellFocus',value:function(a,b){a.index===this._focusedItemIndex&&this.hasAttribute('navigating')&&(this._navigatingIsHidden=!0,this._toggleAttribute('navigating',!1,this)),b===this._focusedItemIndex&&this._navigatingIsHidden&&(this._navigatingIsHidden=!1,this._toggleAttribute('navigating',!0,this))}},{key:'_getColumns',value:function(a,b){var c=this._columnTree.length-1;return a===this.$.header?c=b:a===this.$.footer&&(c=this._columnTree.length-1-b),this._columnTree[c]}},{key:'_resetKeyboardNavigation',value:function(){var a=this;if(this.$.header.firstElementChild&&(this._headerFocusable=this.$.header.firstElementChild.firstElementChild),this.$.items.firstElementChild){var b=this._iterateItems(function(b,c){if(a._firstVisibleIndex===c)return a.$.items.children[b]});b&&(this._itemsFocusable=b.firstElementChild)}this.$.footer.firstElementChild&&(this._footerFocusable=this.$.footer.firstElementChild.firstElementChild)}},{key:'_scrollHorizontallyToCell',value:function(a){var b=Math.round;if(!(a.hasAttribute('frozen')||this._elementMatches(a,'[part~="details-cell"]'))){for(var c,d=a.getBoundingClientRect(),e=a.parentNode,f=Array.from(e.children).indexOf(a),g=this.$.table.getBoundingClientRect(),h=g.left,j=g.right,k=f-1;0<=k;k--)if((c=e.children[k],!(c.hasAttribute('hidden')||this._elementMatches(c,'[part~="details-cell"]')))&&c.hasAttribute('frozen')){h=c.getBoundingClientRect().right;break}for(var i,l=f+1;l<e.children.length;l++)if((i=e.children[l],!(i.hasAttribute('hidden')||this._elementMatches(i,'[part~="details-cell"]')))&&i.hasAttribute('frozen')){j=i.getBoundingClientRect().left;break}d.left<h&&(this.$.table.scrollLeft+=b(d.left-h)),d.right>j&&(this.$.table.scrollLeft+=b(d.right-j))}}},{key:'_elementMatches',value:function(a,b){return a.matches?a.matches(b):-1!==Array.from(a.parentNode.querySelectorAll(b)).indexOf(a)}}],[{key:'properties',get:function(){return{_headerFocusable:{type:Object,observer:'_focusableChanged'},_itemsFocusable:{type:Object,observer:'_focusableChanged'},_footerFocusable:{type:Object,observer:'_focusableChanged'},_navigatingIsHidden:Boolean,_focusedItemIndex:{type:Number,value:0},_focusedColumnOrder:Number}}}]),b}(a)};</script></head><body></body></html>