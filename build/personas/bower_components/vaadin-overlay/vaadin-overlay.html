<html><head><link rel="import" href="../polymer/polymer-element.html"><link rel="import" href="../polymer/lib/utils/templatize.html"><link rel="import" href="../polymer/lib/utils/flattened-nodes-observer.html"><link rel="import" href="../vaadin-themable-mixin/vaadin-themable-mixin.html"></head><body><dom-module id="vaadin-overlay-default-theme"><template><style>:host{top:8px;right:8px;left:8px;bottom:calc(8px + var(--vaadin-overlay-viewport-bottom));}[part="overlay"]{background:#fff;box-shadow:0 2px 8px rgba(0, 0, 0, 0.3);}</style></template></dom-module><dom-module id="vaadin-overlay"><template><style>:host{z-index:200;position:fixed;top:0;right:0;bottom:var(--vaadin-overlay-viewport-bottom);left:0;display:flex;flex-direction:column;align-items:center;justify-content:center;margin:auto;pointer-events:none;-webkit-tap-highlight-color:transparent;--vaadin-overlay-viewport-bottom:0px;}:host([hidden]),
      :host(:not([opened])){display:none !important;}[part="overlay"]{-webkit-overflow-scrolling:touch;overflow:auto;pointer-events:auto;max-width:100%;-webkit-tap-highlight-color:initial;}[part="backdrop"]{z-index:-1;content:"";background:rgba(0, 0, 0, 0.5);position:fixed;top:0;left:0;bottom:0;right:0;pointer-events:auto;}</style><div id="backdrop" part="backdrop" hidden$="{{!withBackdrop}}"></div><div part="overlay" id="overlay"><div part="content" id="content"></div></div></template></dom-module><script>if(!Polymer.Element)throw new Error('Unexpected Polymer version '+Polymer.version+' is used, expected v2.0.0 or later.');{var OverlayElement=function(a){function b(){babelHelpers.classCallCheck(this,b);var a=babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return a._boundMouseDownListener=a._mouseDownListener.bind(a),a._boundMouseUpListener=a._mouseUpListener.bind(a),a._boundOutsideClickListener=a._outsideClickListener.bind(a),a._boundKeydownListener=a._keydownListener.bind(a),a._observer=new Polymer.FlattenedNodesObserver(a,function(b){a._setTemplateFromNodes(b.addedNodes)}),a._boundIronOverlayCanceledListener=function(b){b.preventDefault(),window.removeEventListener('iron-overlay-canceled',a._boundIronOverlayCanceledListener)},/iPad|iPhone|iPod/.test(navigator.userAgent)&&(a._boundIosResizeListener=function(){return a._detectIosNavbar()}),a}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,null,[{key:'is',get:function(){return'vaadin-overlay'}},{key:'properties',get:function(){return{opened:{type:Boolean,notify:!0,reflectToAttribute:!0},template:{type:Object,notify:!0},content:{type:Object,notify:!0},withBackdrop:{type:Boolean,value:!1,reflectToAttribute:!0},modeless:{type:Boolean,value:!1,reflectToAttribute:!0,observer:'_modelessChanged'},focusTrap:{type:Boolean,value:!1},_focusedElement:{type:Object},_mouseDownInside:{type:Boolean},_mouseUpInside:{type:Boolean},_instance:{type:Object},_boundIronOverlayCanceledListener:{type:Object}}}},{key:'observers',get:function(){return['_openedChanged(opened)','_templateChanged(template)','_contentChanged(content)']}}]),babelHelpers.createClass(b,[{key:'ready',value:function(){babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'ready',this).call(this),this._observer.flush(),this.addEventListener('click',function(){}),this.$.backdrop.addEventListener('click',function(){})}},{key:'_detectIosNavbar',value:function(){if(this.opened){var a=window.innerHeight,b=window.innerWidth,c=document.documentElement.clientHeight;b>a&&c>a?this.style.setProperty('--vaadin-overlay-viewport-bottom',c-a+'px'):this.style.setProperty('--vaadin-overlay-viewport-bottom','0px')}}},{key:'_setTemplateFromNodes',value:function(a){this.template=a.filter(function(a){return a.localName&&'template'===a.localName})[0]||this.template}},{key:'close',value:function(a){var b=new CustomEvent('vaadin-overlay-close',{bubbles:!0,cancelable:!0,detail:{sourceEvent:a}});this.dispatchEvent(b),b.defaultPrevented||(this.opened=!1)}},{key:'connectedCallback',value:function(){babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'connectedCallback',this).call(this),this.parentNode===document.body&&window.addEventListener('iron-overlay-canceled',this._boundIronOverlayCanceledListener),this._boundIosResizeListener&&(this._detectIosNavbar(),window.addEventListener('resize',this._boundIosResizeListener))}},{key:'disconnectedCallback',value:function(){babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'disconnectedCallback',this).call(this),window.ShadyDOM&&window.ShadyDOM.inUse?this.parentNode!==document.body&&window.removeEventListener('iron-overlay-canceled',this._boundIronOverlayCanceledListener):!this.parentNode&&window.removeEventListener('iron-overlay-canceled',this._boundIronOverlayCanceledListener),this._boundIosResizeListener&&window.removeEventListener('resize',this._boundIosResizeListener)}},{key:'_mouseDownListener',value:function(a){this._mouseDownInside=0<=a.composedPath().indexOf(this.$.overlay)}},{key:'_mouseUpListener',value:function(a){this._mouseUpInside=0<=a.composedPath().indexOf(this.$.overlay)}},{key:'_outsideClickListener',value:function(a){if(-1!==a.composedPath().indexOf(this.$.overlay)||this._mouseDownInside||this._mouseUpInside)return this._mouseDownInside=!1,void(this._mouseUpInside=!1);if(this._last){var b=new CustomEvent('vaadin-overlay-outside-click',{bubbles:!0,cancelable:!0,detail:{sourceEvent:a}});this.dispatchEvent(b),this.opened&&!b.defaultPrevented&&this.close(a)}}},{key:'_keydownListener',value:function(a){if(this._last)if('Tab'===a.key&&this.focusTrap){var b=this._getFocusableElements(),c=b.indexOf(this._focusedElement);a.shiftKey?this._setFocus(c,-1):this._setFocus(c,1),a.preventDefault()}else if('Escape'===a.key||'Esc'===a.key){var d=new CustomEvent('vaadin-overlay-escape-press',{bubbles:!0,cancelable:!0,detail:{sourceEvent:a}});this.dispatchEvent(d),this.opened&&!d.defaultPrevented&&this.close(a)}}},{key:'_openedChanged',value:function(a){var b=this;a?(this._placeholder=document.createComment('vaadin-overlay-placeholder'),this.parentNode.insertBefore(this._placeholder,this),document.body.appendChild(this),Polymer.Async.idlePeriod.run(function(){b.focusTrap&&b._setFocus(-1,1);var a=new CustomEvent('vaadin-overlay-open',{bubbles:!0});b.dispatchEvent(a)}),!this.modeless&&this._enterModalState()):(this._placeholder&&(this._placeholder.parentNode.insertBefore(this,this._placeholder),this._processPendingMutationObserversFor(document.body),this._placeholder.parentNode.removeChild(this._placeholder)),this._exitModalState())}},{key:'_modelessChanged',value:function(a){a?this._exitModalState():this.opened&&this._enterModalState()}},{key:'_enterModalState',value:function(){document.addEventListener('mousedown',this._boundMouseDownListener),document.addEventListener('mouseup',this._boundMouseUpListener),document.addEventListener('click',this._boundOutsideClickListener,!0),document.addEventListener('keydown',this._boundKeydownListener),this._previousDocumentPointerEvents=document.body.style.pointerEvents,document.body.style.pointerEvents='none'}},{key:'_exitModalState',value:function(){document.removeEventListener('mousedown',this._boundMouseDownListener),document.removeEventListener('mouseup',this._boundMouseUpListener),document.removeEventListener('click',this._boundOutsideClickListener,!0),document.removeEventListener('keydown',this._boundKeydownListener),document.body.style.pointerEvents=this._previousDocumentPointerEvents,delete this._previousDocumentPointerEvents}},{key:'_templateChanged',value:function(a){var b=Polymer.Templatize.templatize(a,this,{forwardHostProp:function(a,b){this._instance&&this._instance.forwardHostProp(a,b)}});this._instance=new b({}),this.content=this._instance.root}},{key:'_contentChanged',value:function(a){this.$.content.appendChild(a)}},{key:'_setFocus',value:function(a,b){if(this.focusTrap){for(var c=this._getFocusableElements(),d=0;d<c.length;d++){a+=b,a===c.length?a=0:-1===a&&(a=c.length-1);var e=c[a];if(this._isVisible(e))return this._focusedElement=e,e.focus()}this._focusedElement=this.$.overlay,this.$.overlay.focus()}}},{key:'_isVisible',value:function(a){return a.offsetWidth||a.offsetHeight||a.getClientRects().length}},{key:'_getFocusableElements',value:function(){var a=Array.from(this.$.content.querySelectorAll('[tabindex], button, input, select, textarea, object, iframe, label, a[href], area[href]')).filter(function(a){return'-1'!==a.getAttribute('tabindex')});return a.sort(function(c,a){return(c=parseInt(c.getAttribute('tabindex'))||0,a=parseInt(a.getAttribute('tabindex'))||0,c===a)?0:0===c?1:0===a?-1:c<a?-1:c>a?1:void 0})}},{key:'_processPendingMutationObserversFor',value:function(a){window.CustomElements&&!Polymer.Settings.useNativeCustomElements&&CustomElements.takeRecords(a)}},{key:'_last',get:function(){return this==Array.from(document.body.children).filter(function(a){return a instanceof Vaadin.OverlayElement}).pop()}}]),b}(Vaadin.ThemableMixin(Polymer.Element));customElements.define(OverlayElement.is,OverlayElement),window.Vaadin=window.Vaadin||{},Vaadin.OverlayElement=OverlayElement}</script></body></html>